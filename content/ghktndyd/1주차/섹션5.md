### 예산 설정
- 돈이 너무 많이 나오지 않도록 설정
### EC2
- Elastic Compute Cloud의 약자
- AWS의 Infrastructure as Service (IAAS) - 이아스라고 발음
- EC2는 하나의 서비스가 아니다. 여러 개의 서비스를 포함하고 있다.
- 가상머신을 EC2에서 임대하면 그게 **EC2 인스턴스**
- 데이터를 **EBS**에 보관 가능
- **ELB**로 로드밸런서 역할 가능
- **ASG**로 오토 스케일링 가능
- Linux가 제일 인기 많음
- 원하는대로 컴퓨팅 사양을 설정하여 EC2 대여 가능
- EC2 부팅할 때 자동화 하는 작업 = 부트스트래핑 (설치, 실행 등)
- **여기서 스크립트는 시작할 때 한 번만 실행**
- EC2 스크립트의 모든 명령문은 sudo로 실행 (루트 계정)

### EC2 인스턴스 유형
- 7가지가 있음
	- 범용 (general purpose)
	- 컴퓨팅 최적화 (compute optimized)
	- 메모리 최적화 (memory optimized)
	- 가속화된 컴퓨팅 (accelerated computing)
	- 스토리지 최적화 (storage optimized)
	- HPC 최적화 (HPC optimized)
	- 인스턴스 기능 (instance features)
	- 인스턴스 성능 측정 (measuring instance performance)

```
m5.2xlarge
- m은 인스턴스 클래스 (m이라면 범용)
- 5는 세대 (5세대)
- 2xlarge (인스턴스 크기)
```

#### 범용
- 웬만해서는 다 잘 어울림
- 클래스 코드: `t`, `m`

#### 컴퓨팅 최적화
- 배치 처리와 같은 일괄 처리
- 미디어 트랜스 코딩, 고성능 웹서버, HPC, 머신러닝, 게임 서버
- 클래스 코드: `c`

#### 메모리 최적화
- 대규모 데이터셋 처리할 때
- 고성능이 필요한 관계형 DB, 비관계형 DB 서버, 분산 웹 스케일 캐시 저장소로

#### 스토리지 최적화
- 로컬 스토리지에서 대규모 데이터셋 처리시
- Redis 같은 메모리 DB의 캐시나 데이터 웨어하우징과 같은 분산 파일 시스템

### 보안 그룹
- EC2 인스턴스 안팎으로 트래픽이 허용되는 방식을 제어
- 허용 규칙만 포함
- IP를 기준으로 설정
- 보안그룹은 서로 참조 가능
- 보안그룹은 **EC2의 방화벽**
- 보안그룹은
	1. 포트의 허용을 규제함
	2. 승인된 IP 범위를 보여줌 (IPv4인가 IPv6인가)
	3. 인바운드 네트워크 제어 (외부에서 인스턴스로)
	4. 아웃바운드 네트워크 제어 (인스턴스에서 외부로)

- 기본적으로 모든 아웃바운드는 열려있다.
- 하지만 인바운드는 보안그룹에서 허용하는 IP와 포트로 요청이 들어와야 한다.
- 하나의 인스턴스는 여러 개의 보안그룹을 가질 수 있다.
- 보안그룹은 리전과 VPC로 통제된다. 이 말은 리전 변경시 새로운 보안그룹을 생성해야 하거나 VPC를 생성해야 한다.
- 보안그룹은 EC2 외부에 있다.
- SSH 액세스를 위한 보안그룹은 따로 유지하는 것이 좋다.
- **만약 타임아웃으로 애플리케이션에 접근이 안 된다면 보안그룹 문제일 가능성이 높다.**
- 하지만 연결이 거부됐다는 응답은 보안그룹을 통과했지만 애플리케이션에 문제가 발생했을 가능성이 높다는 뜻

### 클래식 포트
- 22: SSH
- 21: FTP
- 22 SFTP
- 80: HTTP
- 43: HTTPS
- 3389: RDP

### EC2 인스턴스 옵션
- 그 동안은 AWS의 온디멘드 인스턴스를 썼다.
- 만약 오래 쓸 거라면 Reserved 인스턴스가 있다. 기간은 1년 또는 3년이다.
- Convertible Reserved Instance도 있다. 쓰다가 전환하고 싶으면 이걸 쓰자.
- Savings Plans는 달러 단위로 특정 사용량을 정의해서 쓴다.
- Spot Instance는 짧게 쓸 때 쓰자.
- Dedicated는 전용 인스턴스가 필요할 때

#### 온디멘드
- 온디멘드는 1시간 이후에 초단위로 비용 발생
- 돈 많이 듦.

#### 예약 (Reserved)
- 온디멘드에 비해서 72% 할인
- 특정한 인스턴스 타입을 예약한다.
- 부분 선결제, 전부 선결제, 선결제 없음 중 선택 가능
- 데이터베이스 같은 거 할 때
- 전환형 예약 인스턴스도 있음

#### 절약 (Saving)
- 온디멘드에 비해 70% 할인 가능
- 시간당 10달러
- 1년, 3년 택
- 사용량을 초과하면 온디멘드로 바뀜

#### 스팟 (Spot)
- 온디멘드에 비해 90% 할인
- 최대 가격 지정하고, 그 가격이 넘어간다면 인스턴스가 초기화 됨..
- 배치 작업, 데이터 분석, 이미지 처리 등에 사용
- 중요한 작업을 쓰는 인스턴스로 쓰지 말 것

#### EC2 Dedicated Hosts (EC2 전용 호스트)
- 실제 데이터센터 내의 물리적 서버 하나 임대
- 전용 호스트 사용시 준수 요건을 쉽게 달성하고, 서버 결합 소프트웨어 라이센스의 사용이 가능
- 3년 계약
- 제일 비쌈

#### EC2 Dedicated Instances (전용 인스턴스)
- 전용 하드웨어에서 실행되는 EC2 인스턴스
- 같은 계정의 다른 인스턴스와 하드웨어 공유
- 인스턴스 배치에 통제권 없음
- 전용 인스턴스는 나만의 인스턴스를 나만의 하드웨어에 갖는다.
- 전용 호스트는 하드웨어 서버 하나를 다 갖는다.

#### EC2 용량 예약
- 용량을 예약하는 게 유일한 목적
- 용량을 예약하면 실행 안 해도 요금 청구
- 단기적인 워크로드를 갖고, 특정 AZ에 있는 작업에 유용
